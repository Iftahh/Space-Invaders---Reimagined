(function(){function yb(){if(0!=mb.length){var a=mb.shift(),b=a[1];J.getElementById("text").textContent=a[0];nb+=b;J.getElementById("pbar-in").style.width=2*nb+"px";a[2]();setTimeout(yb,0)}}function zb(a){var b=K(3.5,(a-Ra)/32);Ra=a;a=(Da/3|0)%Ea;if(Sa)if(0>=d.M)Ab();else{var c=E[38]||E[32]||E[87]||E[69]?1.65:.6;d.S=d.d>pa/2||d.d<-pa/2;if(E[37]||E[65]||E[83])d.b.x=S(-10,d.b.x-c),d.G&&(d.S=!0);else if(E[39]||E[68]||E[70])d.b.x=K(10,d.b.x+c),d.G&&(d.S=!1);!d.G&&d.ha&&(d.b.x+=Bb(1.5,d.b.x,.02));ca.K=
!d.R&&(E[38]||E[32]||E[87]||E[69]);c=d.a.y<F;d.b.scale(c?.99:.76);d.b.y=T(-10,20,d.b.y+(ca.K?-.25:d.G?.8:.5));var f=d.b;d.a.add(s(f.x*b,f.y*b));d.d=Math.atan2(C+Cb-d.a.y+.72*r,G+Db-d.a.x);var f=Math.cos(d.d)*e*50,m=D(d.d)*e*50;d.$=.9*d.$+.1*m;d.T=.9*d.T+.1*f;d.a.y>F&&(c&&(v[v.length*(1-(k/2-d.T)/k)|0].j=22*d.b.y,U.K=!0,U.position.x=d.a.x,U.position.y=d.a.y+r-8,U.speed=.75*d.b.y,U.n=20*z(d.b.y)),d.a.y>F+.5*n&&(d.a.y=0));d.a.x>la+k&&(d.a.x=-k);d.a.x<-k&&(d.a.x=la+k);a:{var c=qa(d.a.x/e|0,(d.a.y-.4*
r)/e|0),X=m=f=!1,g=0,q=0;d.ha=c==V||c==ra||1==c;0<d.b.x&&(g=r/4,q=-d.a.x%e);0>d.b.x&&(g=r/-4,q=-d.a.x%e+e);sa(d.a.x+g,d.a.y-.8*r)&&(m=!0,sa(d.a.x+g,d.a.y-.6*r)&&(f=!0));sa(d.a.x+g,d.a.y+2*e)&&(X=!0,sa(d.a.x+g,d.a.y)&&(f=!0));if(X||m)if(f&&(d.b.x*=-.3,d.a.x+=q),.2>z(d.b.y)?d.b.y=0:d.b.y*=0<d.b.y&&X||0>d.b.y&&m?-.3:.3,m&&(d.a.y+=e-d.a.y%e,f||(d.a.y+=e),d.b.x*=.2),X){d.a.y-=d.a.y%e;f&&(d.a.y-=e);d.G=!0;Eb=0;break a}6<Eb++&&(d.G=!1)}d.G?.3>z(d.b.x)?d.b.x=0:d.b.x*=.8:d.a.y<-20*e&&(d.R=20);0<d.R&&d.R--;
Fa&&4>d.p?(Ta.d=360*d.d/x,Ta.e(d.a.x,d.a.y-.72*r),d.p++,4<=d.p&&(d.p+=5)):4<=d.p&&(d.p--,4>d.p&&(d.p=0))}c=d.a.y<dc;0<d.M&&(C=d.a.y-n/2+d.$|0,G=d.a.x-k/2+d.T|0);t.setTransform(1,0,0,1,-G,-C);A.setTransform(1,0,0,1,-G,-C);c&&(Ua.setTransform(1,0,0,1,-G,-C),ob.position.x=d.a.x-30*e);Sa&&(F>Va-200*e&&(F-=.005*b),ca.position.x=d.a.x-(d.S?-5:5),ca.position.y=d.a.y-15,ec(b),Ta.update(b),updateAliens(b),ta.update(b),ca.update(b),Wa.update(b),U.update(b),O.update(b),c&&(ob.update(b),ga.update(b)),A.clearRect(G,
C,k,n),Ua.clearRect(G,C,k,n),t.clearRect(G,C,k,n),t.save(),t.globalCompositeOperation="lighter",ca.t(t),ta.t(t),t.restore(),Wa.t(t),t.beginPath(),Ta.t(t),t.strokeStyle=ma([250,60,60,.4]),t.lineWidth=7,t.stroke(),t.lineWidth=2,t.strokeStyle=ma([255,190,190,.9]),t.stroke(),O.t(t),renderAliens(t),c&&(ob.t(Ua),ga.t(Ua)),Xa&&(b=d.a,c=d.d,f=Xa,t.save(),t.translate(b.x-r/2,b.y-r),d.S&&(t.translate(r,0),t.scale(-1,1),c=pa-c),t.drawImage(f,0,0,r,r,0,0,r,r),t.translate(r/3+r/9,r/3),t.rotate(c),t.drawImage(f,
r,0,r,r,-r/3,-r/3,r,r),t.restore()));A.save();U.t(A);A.restore();d.a.y>F-n&&(Fb!=a&&(A.fillStyle=Ga[a],Fb=a),fc());na.save();a=-.3*G;b=T(-1,0,-1.1*C/Va)*n;na.translate(a,b);na.fillRect(-a,-b,k,n);na.restore();var m=G+k/2,p=C+n/2,m=m-Y/2,p=p-Z/2,X=Ha[oa];a=m-ua;b=p-va;c=z(a);f=z(b);if(c||f){if(c>Y||f>Z)ua=m,va=p,wa(X,m,p,0,0,Y,Z);else if(200<c||200<f){ua=m;va=p;var u,P,h,pb,X=0;0>a?(u=c,P=0):(u=0,P=c);0>b?(h=f,pb=0):(pb=f,h=0);var l=Y-c,w=Z-f,g=1-oa,q=Ha[g];q.clearRect(0,0,Y,Z);q.drawImage(qb[oa],
P,pb,l,w,u,h,l,w);0>b?(wa(q,m,p,0,0,Y,f),X=f,p+=f):wa(q,m,p+Z-f,0,Z-f,Y,f);0>a?wa(q,m,p,0,X,c,Z-f):(m+=Y-c,wa(q,m,p,Y-c,X,c,Z-f));oa=g;a=b=0}L.clearRect(0,0,k,n);L.drawImage(qb[oa],200+a,200+b,k,n,0,0,k,n)}Gb();Ya(zb);Da++;L.fillText("Health: "+d.M+" out of "+d.ta+"   Wind: 1.5",k/2,n-50);d.R&&L.fillText("Engine FROZEN!",k/2,n/2-100)}function Hb(a){var b=a.position.x;O.e(b,a.position.y);if(a=v[v.length*(1-(b-G)/k)|0+w(-1,2)])a.j+=1}function Bb(a,b,c){a-=b;return T(-10,10,z(a)*a*c)}function Za(){return 1.5}
function Ib(){return d.ha?1.5:0}function gc(a){return $a(k,n,function(b){var c=new Int8Array(k*n),f=new Int8Array(k*n),m=0;ha(k,n,function(b,g){c[m]=xa(5*(b-k/2)/(3*g/n+.6)+5*D(a+x*(b+2*g)/k)+3*D(a+2*x*(b+g)/k));f[m]=xa(5*(2*g/n+.6)*D(a+4*x*(b+g/2)/k)*D(a+3.5*x*(b+g)/k));m++});hc(c,f,$,b,k,n)})}function da(){if(Ga.length<Ea){if(!$){$=[];for(var a=0,b=0;b<n;b++)for(var c=w(5,25),f=w(10,35),m=w(20,40),d=0;d<k;d++){var g=w(25,50),q=w(30,65),e=w(70,120);$[a++]=20+(g+c>>1)+xa(5*D(b*x/10));$[a++]=25+(q+
f>>1)+xa(5*D(b*x/12));$[a++]=30+(e+m>>1)+xa(8*D(b*x/13));$[a++]=255;c=g;f=q;m=e}a=[];Jb({data:$,width:k,height:n},a,[.1,.1,.1,.1,.2,.1,.1,.1,.1]);$=a}Ga.push(A.createPattern(gc(Ga.length*x/Ea),"repeat"))}}function fc(){if(!(C+2*n<F)){A.translate(G,0);A.beginPath();A.moveTo(k,C+n);A.lineTo(0,C+n);var a=0;M(v,function(b){A.lineTo(a,b.height+3*D((a-5.25*Da)/322*x+4*D((a-3*Da)/511*x)+4*D((a-1.5*Da)/733*x)));a+=Kb});A.closePath();A.fill();A.stroke()}}function ec(a){var b=0;M(v,function(c){c.j+=a*(-.04*
(c.height-F)-.025*c.j);c.height+=c.j*a;b=S(b,z(c.j))});if(1<b){var c=[],f=[];B(Lb,function(){for(var a=0;a<v.length;a++)0<a&&(c[a]=.25*(v[a].height-v[a-1].height),v[a-1].j+=c[a]),a<v.length-1&&(f[a]=.25*(v[a].height-v[a+1].height),v[a+1].j+=f[a]);for(a=0;a<v.length;a++)0<a&&(v[a-1].height+=c[a]),a<v.length-1&&(v[a+1].height+=f[a])})}}function sa(a,b){return Ia[qa(a/e|0,b/e|0)]}function Mb(a,b){var c=Nb[qa(a,b)];return void 0===c?ab:c}function qa(a,b){return 0>b?V:0>a?b>=1E3-.4*a?bb:V:2048<=a?b>=1E3+
.4*(a-2048)?bb:V:1E3<=b?bb:ya[2048*b+a]}function rb(a,b,c){for(var f=c*c,m={},d=0;d<c;d++){var g=sb(f-d*d),q=b+g-K(.4*g,4*e);Ob(a+d,a-d,b-g,q,cb,m);Ob(a+d,a-d,q,b+g,ab,m)}c+=2*e;Q=K(Q,a-c);W=K(W,b-c);ia=S(ia,a+c);ja=S(ja,b+c)}function Ob(a,b,c,f,m,d){for(;c<f;c+=e)for(var g=2048*(c/e|0),g=[g+(a/e|0),g+(b/e|0)],q=0;2>q;q++){var p=g[q];if(!d[p]){d[p]=1;var u=ya[p];u!=bb&&u!=V&&u!=m&&(m==ab&&u!=tb&&(m=cb),m==cb&&u!=tb&&u!=cb&&u!=ab&&(m=V),ya[p]=m)}}}function Gb(){1E7>Q&&(Ha[oa].clearRect(Q-ua,W-va,ia-
Q-3,ja-W-3),wa(Ha[oa],Q,W,Q-ua-1,W-va-1,ia-Q+1,ja-W+1),Q=W=1E7,ia=ja=-1E7)}function db(a,b,c){ya[2048*b+a]=c;a*=e;b*=e;c=2*e;var f=K(Q,a-c);minDirtyY2=K(W,b-c);maxDirtyX2=S(ia,a+c);maxDirtyY2=S(ja,b+c);if(maxDirtyY2-minDirtyY2>100*c||maxDirtyX2-f>100*c)Gb(),f=K(Q,a-c),minDirtyY2=K(W,b-c),maxDirtyX2=S(ia,a+c),maxDirtyY2=S(ja,b+c);Q=f;W=minDirtyY2;ia=maxDirtyX2;ja=maxDirtyY2}function wa(a,b,c,f,m,d,g){var q=d/e|0,p=g/e|0,u=b/e|0;b=c/e|0;var P=ua;c=va;a.save();a.translate(-P,-c);a.rect(P+f,c+m,d,g);
a.clip();f-=e;f-=f%e;m-=e;m-=m%e;for(var q=q+4,p=p+2,P=P+f,k=c+m,h=b;h<b+p;h++){var r=Mb(u,h),n=0;B(q,function(b){var c=Mb(u+b,h);if(c!=r||b>=q-1){if(r){a.fillStyle=r;a.beginPath();a.moveTo(P+n*e+ea[z(11*n+3*h)%80],k+ea[z(9*n+7*h)%80]);for(var f=n+1;f<=b;f++)a.lineTo(P+f*e+ea[z(11*f+3*h)%80],k+ea[z(9*f+7*h)%80]);f--;for(a.lineTo(P+f*e+ea[z(11*f+3*(h+1))%80],1+k+e+ea[z(9*f+7*(h+1))%80]);f>=n;f--)a.lineTo(P+f*e+ea[z(11*f+3*(h+1))%80],1+k+e+ea[z(9*f+7*(h+1))%80]);a.closePath();a.fill()}n=b}r=c});k+=
e}a.restore()}function Ja(a,b,c){return $a(l,l,function(f){var m=0;ha(l,l,function(d,g){f[m++]=a(d,g);f[m++]=b(d,g);f[m++]=c(d,g);f[m++]=255})})}function ic(){return function(a){var b=K(a.m,.4);return Ka((b+.08)/2,(a.I+.31)/2,(a.b+.16)/2)}}function Pb(a,b){ca.d=-90;O.speed*=3;var c=e*b;ta.V(eb[a.F]);B(12*b*b,function(){ca.e(a.x+w(-2*c,2*c),a.y+w(-3*c,c));O.e(a.x+w(-2*c,2*c),a.y+w(-2*c,c));ta.e(a.x+w(-2*c,2*c),a.y+w(-2*c,2*c))});ca.d=90;O.speed/=3}function jc(a){var b=!1;0<za?(za-=a,M(fb,function(b){b.y+=
a*z(gb)/2}),0>=za&&(hb=40,gb=T(-10*h,10*h,-1.05*gb))):(hb-=a,M(fb,function(b){b.x+=gb*a}));M(Aa,function(c){var f=fb[c.F];c.x=f.x+e*(20*c.la+6*D(10*(c.la+3*c.ma)/x+.001*Ra));if(!(0>=c.N)){c.y=f.y+c.ma*e*10;0<c.W&&(c.W-=a,c.x+=y(-e,e),c.y+=y(-e,e));if(c.x<-20*e||c.x>la+20*e)b=!0;qa(c.x/e|0,c.y/e|0)!=V&&(b=!0,c.N--,rb(c.x,c.y,16))}});b&&0>=za&&0>=hb&&(za=20)}function Qb(a){E[a.keyCode]="keydown"==a.type;(32==a.keyCode||37<=a.keyCode&&40>=a.wa)&&a.preventDefault()}function Ab(){d.M=0;Sa=!1;ib.innerHTML=
"<h1>Game Over</h1>Better luck next time.<br><br>Press Refresh (F5) to start over.";ib.style.display="block"}function ka(a,b){var c={s:0,w:0,f:.3,J:function(){},aa:function(a,b){var c=b.size,g=c>>1,d=b.position.x|0,e=b.position.y|0,u=a.createRadialGradient(d,e,b.ka,d,e,g);u.addColorStop(0,b.oa);u.addColorStop(1,b.pa);a.fillStyle=u;a.fillRect(d-g,e-g,c,c)},ra:function(a,b){this.V({U:a,H:[],fa:[],K:!1,r:s(0,0),l:s(0,.3),elapsedTime:0,duration:-1,n:0,B:0,Z:0,A:0,u:0,v:0,C:0,B:0});this.V(b||{})},V:function(a){for(var b in a)this[b]=
a[b];this.i||(this.i=this.size);this.n||(this.n=this.U/this.q);this.s&&(this.s=ma(this.s))},e:function(a,b){if(this.H.length>=this.U)return null;var c=this.fa.shift()||{position:s()};this.sa(c,a||this.position.x,b||this.position.y);this.H.push(c);return c},sa:function(a,b,c){a.position.x=b+this.r.x*y(-1,1);a.position.y=c+this.r.y*y(-1,1);b=(this.d+this.A*y(-1,1))*(pa/180);b=s(Math.cos(b),D(b));c=this.speed+this.v*y(-1,1);a.direction=s(b.x*c,b.y*c);a.size=this.size+this.u*y(-1,1);a.size=1>=a.size?
1:a.size|0;a.i=this.i+this.u*y(-1,1);a.f=this.f;a.c=this.q+this.Z*y(-1,1);a.g=this.g+this.C*y(-1,1);a.g=100<a.g?100:0>a.g?0:a.g;a.ka=a.size/200*a.g|0;if(this.h){var g=[this.h[0],this.h[1],this.h[2],this.h[3]];if(this.D){var d=this;B(4,function(a){g[a]+=d.D[a]*y(-1,1)})}this.k&&(b=[this.k[0]+this.o[0]*y(-1,1),this.k[1]+this.o[1]*y(-1,1),this.k[2]+this.o[2]*y(-1,1),this.k[3]+this.o[3]*y(-1,1)],a.L=[(b[0]-g[0])/a.c,(b[1]-g[1])/a.c,(b[2]-g[2])/a.c,(b[3]-g[3])/a.c]);a.color=g}a.ca=(a.i-a.size)/a.c},update:function(a){a/=
31;if(this.K&&0<this.n){var b=1/this.n;for(this.B+=a;this.H.length<this.U&&this.B>b;)this.e(),this.B-=b;-1!=this.duration&&(this.elapsedTime+=a,this.duration<this.elapsedTime&&this.va())}var c=this;M(this.H,function(b,d){if(0<b.c){if(c.l){var m=b.direction,e=c.l;b.direction=s(m.x+e.x,m.y+e.y)}c.w&&(b.direction.x+=Bb(c.w(b),b.direction.x,b.f));b.position.add(b.direction);b.c-=a;c.J(b,d)}0<b.c?(b.size+=b.ca*a,b.ka=b.size/200*b.g|0,b.L&&(b.color[0]+=b.L[0]*a,b.color[1]+=b.L[1]*a,b.color[2]+=b.L[2]*a,
b.color[3]+=b.L[3]*a),b.color&&(b.pa=c.s||ma(b.color,0),b.oa=ma(b.color))):(c.H.splice(d,1),c.fa.push(b))})},va:function(){this.K=!1;this.B=this.elapsedTime=0},t:function(a){var b=this;M(this.H,function(c){b.aa(a,c)})}};c.ra(a,b);return c}function ma(a,b){return"rgba("+[T(0,255,a[0]|0),T(0,255,a[1]|0),T(0,255,a[2]|0),T(0,1,void 0!=b?b:a[3].toFixed(2))].join()+")"}function kc(a,b){return s(a.x-b.x,a.y-b.y)}function s(a,b){return{x:a||0,y:b||0,scale:function(a){this.x*=a;this.y*=a},add:function(a){this.x+=
a.x;this.y+=a.y},sub:function(a){this.x-=a.x;this.y-=a.y}}}function Rb(a,b,c,f){return $a(b,c,function(d){for(var e=0,g=0;g<c*b;){for(var q=a[e++],p=0;16>p;p++){var u=255*(q&3)/3|0,h=4*(g+15-p),q=q>>2;d[h++]=~f&1?u/2:u;d[h++]=~f&2?u/2:u;d[h++]=~f&4?u/2:u;d[h++]=0==u?0:255}g+=16}})}function ub(a,b){var c=a.canvas.width,f=a.canvas.height,d=aa(c,f),e=vb(a,H(d),[-1,0,0,0,0,0,-2,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0]),g=aa(c,f),q=vb(a,H(g),[0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,-2,0,0,0,0,0,-1]),p=0,e=b?e:
q,h=e.data,q=d,k=g;B(c*f,function(){B(3,function(){h[p]=255-h[p];p++});p++});b&&(q=g,k=d);H(k).putImageData(e,0,0);a.globalCompositeOperation="darken";a.drawImage(k,0,0,c,f);a.globalCompositeOperation="lighter";a.drawImage(q,0,0,c,f)}function vb(a,b,c){var f=wb(a);a=(b||a).createImageData(f.width,f.height);Jb(f,a.data,c);b&&b.putImageData(a,0,0);return a}function Jb(a,b,c){var f=xa(sb(c.length)),d=f/2|0,e=a.data,g=a.width,q=a.height,p=0;ha(g,q,function(a,h){var k=0,n=0,r=0,l=e[4*(h*g+a)+3];ha(f,f,
function(b,p){var l=h+p-d,s=a+b-d,l=l+10*q,l=l%q,s=s+10*g,s=s%g,l=4*(l*g+s),s=c[p*f+b];k+=e[l]*s;n+=e[l+1]*s;r+=e[l+2]*s});b[p++]=k;b[p++]=n;b[p++]=r;b[p++]=l})}function hc(a,b,c,f,d,e){var g=0,q=0,p=20*d,h=20*e;ha(d,e,function(k,n){var l=a[q],r=b[q];q++;l=4*((k-l+p)%d+(n-r+h)%e*d);f[g++]=c[l++];f[g++]=c[l++];f[g++]=c[l++];f[g++]=c[l]})}function La(a,b){var c=wb(a),d=c.data,m=0;B(c.width*c.height,function(){var a=d[m],c=d[m+1],e=d[m+2],a=a/255,c=c/255,e=e/255,p,h,k,l=Math.max(a,c,e),n=l-Math.min(a,
c,e);0==n?a=k=0:(k=n/l,p=(l-a)/6/n+.5,h=(l-c)/6/n+.5,e=(l-e)/6/n+.5,a=a===l?e-h:c===l?1/3+p-e:2/3+h-p,0>a?a++:1<a&&a--);k=b({m:a,I:k,b:l});d[m++]=k.ua;d[m++]=k.qa;d[m++]=k.na;m++});a.putImageData(c,0,0)}function Ka(a,b,c){void 0===b&&(b=a.I,c=a.b,a=a.m);var d=6*a|0,e=6*a-d;a=c*(1-b);var h=c*(1-e*b);b=c*(1-(1-e)*b);var g,q,p;switch(d%6){case 0:g=c;q=b;p=a;break;case 1:g=h;q=c;p=a;break;case 2:g=a;q=c;p=b;break;case 3:g=a;q=h;p=c;break;case 4:g=b;q=a;p=c;break;case 5:g=c,q=a,p=h}return{ua:255*g|0,qa:255*
q|0,na:255*p|0}}function I(a,b,c,d,e,h,g,q,p,k){function l(r,s){var t=s*a+r;try{return n[t]?n[t]:n[t]=fa(k)|0?T(0,255,(fa(p)|0)+l((a+r-w(e,h))%a,(b+s-w(g,q))%b)):w(c,d)}catch(v){return n[t]=w(c,d)}}var n=[];return l}function R(a,b,c){mb.push([a,b,c])}function $a(a,b,c){a=aa(a,b);b=H(a);var d=wb(b);c(d.data,b,a);b.putImageData(d,0,0);return a}function wb(a){return a.getImageData(0,0,a.canvas.width,a.canvas.height)}function w(a,b){return y(a,b)|0}function y(a,b){return a+fa(b-a)}function fa(a){return ba()*
a}function xb(a){return a*a}function H(a){return a.getContext("2d")}function aa(a,b){var c=J.createElement("canvas");c.width=a||k;c.height=b||n;return c}function ha(a,b,c){for(var d=0;d<b;d++)for(var e=0;e<a;e++)c(e,d)}function T(a,b,c){return K(b,S(a,c))}function M(a,b){for(var c=a.length-1;0<=c&&!b(a[c],c);c--);}function lc(a){for(var b=0;2>b&&!a(b);b++);}function B(a,b){for(var c=0;c<a;c++)b(c)}function ba(){var a=2091639*N.X+N.O*N.P;N.X=N.Y;N.Y=N.Q;N.O=a|0;N.Q=a-N.O;return N.Q}var Ma=250,Sb=400,
Ea=10,Lb=8,Tb=1,Ub=450,e=7,k=1E7,n=0,h=1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(Ma=200,Sb=300,Ea=5,Lb=4,Tb=1,Ub=300);for(;(n>innerHeight||k>innerWidth)&&3<e;)e--,h=e/7,k=1715*h|0,n=1400*h|0;var la=2048*e,Va=1E3*e,F=Va-150,Ga=[],G=0,C=0,N={ja:function(a){a=1>a?1/a:a;this.X=(a>>>0)*this.P;a=69069*a+1>>>0;this.Y=a*this.P;this.Q=(69069*a+1>>>0)*this.P;this.O=1;return this},X:0,Y:0,Q:0,O:0,P:2.3283064365386963E-10};N.ja(5);var Vb=[],Ba=[],J=document;
J.getElementById("overlay").style.width=k+"px";J.getElementById("overlay").style.left=(-k>>1)+"px";var mc=J.getElementById("canvas_cont");B(5,function(){var a=aa();a.style.left=(-k>>1)+"px";mc.appendChild(a);Vb.push(a);Ba.push(H(a))});var na=Ba[0],Ua=Ba[1],L=Ba[2],t=Ba[3],A=Ba[4],z=Math.abs,K=Math.min,S=Math.max,D=Math.sin,xa=Math.round,sb=Math.sqrt,pa=Math.PI,x=2*pa,Ya=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame;if(!Ya)var Wb=0,Ya=function(a){var b=
Date.now(),c=S(0,16-(b-Wb));window.setTimeout(function(){a(b+c)},c);Wb=b+c};var mb=[],d={a:s(50*e,900*e),b:s(),$:0,T:0,M:25,ta:25,p:0},Xa=0,r=64*h|0;R("Chasing Sprites",4,function(){var a=Rb([0,0,0,44016,0,0,176124,0,0,152917,0,0,177556,0,0,174826,0,1024,174680,5119,-2096,174752,1365,1431655764,175088,5467,-445688492,437244,86,-50380800,437247,6,-1124253696,1747967,1,-1359396864,437247,0,1788870656,1485823,0,444596224,1485823,0,83886080,1485567,0,0,1747711,0,0,1485804,0,0,48175,0,0,15407,0,0,11307,
0,0,11304,0,0,11307,0,0,11051,0,0],48,24),b=aa(2*r,r),b=H(b);b.drawImage(a,0,0,2*r,r);ub(b,!0);Xa=aa(2*r,r);var a=H(Xa),c=b.getImageData(0,0,2*r,r).data,b=a.createImageData(2*r,r),d=b.data,e=0;ha(2*r,r,function(){d[e]=c[e];e++;d[e]=c[e];e++;d[e]=c[e]/2;e++;d[e]=c[e];e++});a.putImageData(b,0,0);da()});var Eb=0,E={};J.onkeydown=Qb;J.onkeyup=Qb;J.body.addEventListener("touchmove",function(a){a.preventDefault()},!1);var Db=0,Cb=0,Fa=0;J.onmousemove=function(a){var b=Vb[1].getBoundingClientRect();Db=a.clientX-
b.left;Cb=a.clientY-b.top};J.onmousedown=function(a){Fa|=1<<a.button};J.onmouseup=function(a){Fa&=~(1<<a.button)};var Ca=[[47,-67108864,42,-1442840576,170,-1442840576,170,-1442840576,11946,-1430781952,10922,-1431568384,9898,-1431830528,785066,-1431314432,682666,-1431658496,956074,-1431916544,9278826,-1454001664,43423066,-1453932672,44734294,-1512658240,40539994,-1512658240,40539482,-1453938048,44737898,-1453675904,40544917,1521134208,39496277,1437160832,11183735,2006624768,9813,1436024832,9821,-577110016,
632149,1448779776,693338,-1457868800,692377,1761976320,6963221,1442950784,111486608,93350592,127149712,94378560,23864896,26219968,10488192,6294016],[770048,1032192,704512,1024E3,688128,1024E3,698368,15376384,698880,65699840,11776,48758784,10752,48758784,961194,-357924864,961194,-1431576576,961194,-1431642112,16411306,-1432950272,66737834,-1437159936,65689002,-1453937152,44727658,-1510560256,-22381142,-1443189848,-22369622,-1431655432,-1096111446,-1431655768,-1431655766,-1431660888,-1436898731,1437247144,
-1458918787,2108318120,-1458918742,-1431678552,-1458918742,-1431662172,-1459191808,692644,1762033664,692564,-1794790828,-1788198312,67201636,1520762880,27300,1519648768,5476,-1789394944,10836,-1431830528],[682,-1434451968,3071,-1414529024,16362,-1430519808,44760746,-1431655808,44739242,-1431655552,48933546,-1431654464,732605098,-1431655432,1051372202,-1431655430,984263338,-1431655686,715806378,-1433032006,715806058,-1454003542,715825002,-1443452246,715824986,-1510561110,715827882,-1431655766,1789569706,
-1431655766,447326890,-1431741786,357935773,1990874452,1747613,1990890496,1747605,1454023936,22697386,-1432966848,27935066,-1543411136,27934746,-1543411136,22697301,1414899008,1742080,5936384,1485312,5936384,1399040,5854208,349440,5586944]],eb=[],Aa=[],Na=[],fb=[],gb=2.5*h,za=0,hb=0;renderAliens=function(a){M(Aa,function(b){a.drawImage(Ca[b.F],b.x-b.ba/2,b.y-b.m/2)});M(Na,function(b){a.fillStyle=ma(eb[b.F].h);a.fillRect(b.x-5,b.y-5,10,10)})};updateAliens=function(a){jc(a);M(Aa,function(b,c){5>b.N&&
.3>ba()&&O.e(b.x,b.y);if(0>=b.N){if(b.b=K(3*e,(b.b||0)+.3),b.y+=b.b*a,.6>ba()&&O.e(b.x,b.y),sa(b.x,b.y)||b.y>F+20*e)Pb(b,2),Aa.splice(c,1),rb(b.x,b.y,6*e)}else{b.y>F+10*e&&(Ab(),C=b.y-n/2,G=b.x-n/2);var f=10*e,m=d.a.x-b.x+y(-f,f),h=d.a.y-b.y+y(-f,f),g=m*m+h*h,f=f*f;ba()<.001*a*(g<40*f?3:1)&&100>Na.length&&(g>99*f?(m=0,h=1):(g=sb(g),m/=g,h/=g),Na.push({x:b.x,y:b.y,F:b.F,da:e*m,ea:e*h}))}});Ia[ra]=1;M(Na,function(b,c){lc(function(){b.x+=b.da*a;b.y+=b.ea*a;var f=b.x>G-k&&b.x<G+k&&b.y>C-n&&b.y<C+n;f&&
(ta.V(eb[b.F]),ta.e(b.x,b.y));var m=!1;z(b.x-d.a.x)+z(b.y-d.a.y+r/2)<r&&(d.M--,d.a.x+=b.da,d.a.y+=b.ea,m=!0);sa(b.x,b.y)&&(m=!0,rb(b.x,b.y,3*e));if(m)return Na.splice(c,1),f&&Pb(b,1),!0})});Ia[ra]=0};R("Beaming Aliens",4,function(){B(3,function(a){var b=Rb(Ca[a],32,Ca[a].length/2,1<<a),c=aa(64*h,2*b.height*h);H(c).drawImage(b,0,0,c.width,c.height);Ca[a]=c});for(var a=0;6>a;a++){fb.push({x:20*e,y:e*(30+20*a)});for(var b=a>>1,c=0;12>c;c++)Aa.push({la:c,ma:a,F:b,ba:Ca[b].width,m:Ca[b].height,N:10,W:0})}B(3,
function(a){var b={k:[50,50,50,.2],o:[10,10,10,0],h:[220,225,225,.9],D:[5,5,5,0]};b.k[a]=140;b.h[a]=250;eb.push(b)});da()});var Xb,jb={};R("Painting Sky",10,function(){Xb=$a(Ma,2*n,function(a){var b=0;B(Ma,function(){a[b++]=40;a[b++]=50;a[b++]=80;a[b++]=255});var c=105/n,d=4*Ma;ha(Ma,2*n-1,function(){a[b]=(a[b-4]+a[b-d]+(fa(2)|0)>>1)+(ba()<c?fa(2)|0:0);b++;a[b]=(a[b-4]+a[b-d]+(fa(2)|0)>>1)+(ba()<c?fa(2)|0:0);b++;a[b]=(a[b-4]+a[b-d]+(fa(2)|0)>>1)+(ba()<c?fa(2)|0:0);b++;a[b++]=255})});na.fillStyle=
na.createPattern(Xb,"repeat-x");na.fillRect(0,0,k,n);da()});R("Blowing Clouds",10,function(){for(var a=6;30>a;a++){jb[a]=[];for(var b=30+4*a,c=0;c<Tb;c++){var d=aa(120,60),e=H(d);e.scale(2,1);for(var h=0;4>h;h++){var g=w(22.5,37.5),q=w(22.5,37.5),p=e.createRadialGradient(g,q,15,g,q,22.5),k=b+w(-10,10),l="rgba("+k+","+k+","+k+",0)";p.addColorStop(0,"rgba("+k+","+k+","+k+",.8)");p.addColorStop(1,l);e.fillStyle=p;e.arc(g,q,30,0,x);e.fill()}jb[a].push(d)}}da()});var l=Sb,kb,Yb,Zb,Oa,lb,$b,ac,bc,cc,Pa;
R("Chiseling Rocks",10,function(){function a(a,b){return function(c,d){return S(b,a(c,d))}}kb=Ja(I(l,l,120,180,-3,3,-3,3,-1,200),I(l,l,70,130,-3,3,-3,3,-1,100),I(l,l,40,80,-3,3,-3,3,-2,100));var b=Ja(I(l,l,60,180,-1,2,1,3,-2,100),I(l,l,70,220,-1,2,1,3,-1,200),I(l,l,70,100,-1,2,1,3,-3,100)),c=Ja(a(I(l,l,60,110,1,3,-3,0,-4,100),20),a(I(l,l,80,160,1,3,-3,0,-2,500),30),a(I(l,l,20,40,1,3,-3,0,4,1E3),80));Yb=L.createPattern(b,"repeat");La(H(b),function(a){return Ka(a.m,a.I/4,.4*a.b)});Zb=L.createPattern(b,
"repeat");La(H(c),function(a){return Ka(a.m,.1*a.I,T(.75,1,1.1*a.b))});ac=L.createPattern(c,"repeat");da()});R("Chiseling Rocks",10,function(){lb=Ja(I(l+7,l+7,80,140,-2,4,-2,4,2,300),I(l+7,l+7,80,140,-2,4,-2,4,-1,300),I(l+7,l+7,40,80,-2,4,-2,4,-2,300));var a=Ja(I(l,l,30,50,1,4,1,4,5,100),I(l,l,120,180,1,4,1,4,-2,200),I(l,l,150,220,1,4,1,4,-2,200));Oa=H(lb);Pa=H(kb);var b=H(a);La(b,function(a){return Ka(a.m,.3*a.I,.5*a.b)});M([Oa,Pa,b],function(a){vb(a,a,[.1,.1,.1,.1,.2,.1,.1,.1,.1])});bc=L.createPattern(a,
"repeat");da()});R("Chiseling Rocks",10,function(){ub(Oa);La(Oa,function(a){return Ka(a.m,.3*a.I,.5*a.b)});ub(Pa);La(Pa,ic());cc=L.createPattern(kb,"repeat");$b=L.createPattern(lb,"repeat");kb=lb=Oa=Pa=0;da()});var ya,Y=k+400,Z=n+400,ea=[],oa=0,qb=[],Ha=[];R("Digging Caves",10,function(){N.ja(1);var a=aa(2048,1E3),b=H(a),a=ma([0,0,0,0]);b.fillStyle=a;b.fillRect(0,0,2048,1E3);b.shadowColor="#400000";b.shadowBlur=0;b.shadowOffsetX=0;b.shadowOffsetY=-14;b.fillStyle="#600000";var c=[];c[2048]=0;(function(a,
b,c){var d=a.length-1;c=Math.pow(2,-c);b*=c;var e=d/2;for(a[0]=a[d]=0;e;){for(var f=e;f<d;f+=2*e)a[f]=b*y(.2,1)+(a[f-e]+a[f+e])/2;b*=c;e>>=1}})(c,1500,.7);b.beginPath();b.lineTo(0,1E3);B(2048,function(a){c[a]+=400*xb(D(2*x*a/2048))*xb(D(pa+3*x*a/2048));c[a]*=1/(1+xb(.001*(a-1024)));b.lineTo(a,1E3-c[a])});b.lineTo(2049,1E3);b.closePath();b.fill();b.clip();b.shadowOffsetY=3;b.lineWidth=22;b.shadowColor="#800000";b.beginPath();b.strokeStyle="#a00000";b.moveTo(0,600);b.lineTo(2048,900);b.moveTo(0,900);
b.lineTo(2048,600);b.moveTo(204.8,0);b.lineTo(1433.6,810);b.moveTo(1843.2,0);b.lineTo(614.4,810);b.stroke();b.beginPath();b.fillStyle="#a00000";b.arc(204.8,750,30,0,x);b.arc(1843.2,750,30,0,x);b.fill();ya=new Uint8Array(2048E3);var d=b.getImageData(0,0,2048,1E3).data,e=0,h=0;ha(2048,1E3,function(a,b){var k=d[e+=4]>>5,l=b/1E3;.4>l&&(k==ra||k==tb)&&b<1E3-c[a]+100*(.4-l)&&(k=Qa);ya[h++]=k})});B(2,function(){var a=aa(Y,Z);qb.push(a);Ha.push(a.getContext("2d"))});B(80,function(){ea.push(w(-(e>>1),1+(e>>
1)))});var Nb={},Q=1E7,W=1E7,ia=-1E7,ja=-1E7,Ia={6:1,3:1,7:1},V=0,ra=2,tb=3,ab=4,cb=5,bb=6,Qa=7;R("Digging Caves",10,function(){Nb=[0,Zb,Yb,$b,bc,cc,"#333",ac];da()});var ua=1E7,va=0,$;R("Waving waves",10,function(){B(Ea-Ga.length,function(){da()});$=null});A.strokeStyle="rgba(200,200,250,0.3)";A.lineWidth=3;var Kb=10,v=[];B(k/Kb+1,function(){v.push({height:F,j:0})});A.globalAlpha=.9;var Da=0,Fb,Sa=!1,ca=ka(350,{position:s(),d:90,A:10,duration:-1,k:[200,45,10,0],o:[40,40,40,0],l:s(0,.03),q:1,r:s(4,
6),g:12,C:12,size:30*h|0,i:75*h|0,s:[40,20,10,0],u:5*h,speed:4*h,v:1*h,n:140,h:[220,188,88,1],D:[32,35,38,0],J:function(a){if(a.position.y>F)a.c=0,Hb(a);else{var b=(a.position.x/e|0)+1,c=(a.position.y/e|0)+1,d=qa(b,c);d==ra||d==Qa?(a.c=0,O.e(a.position.x,a.position.y),d==Qa?(U.speed=3*h,U.e(a.position.x,a.position.y),db(b,c,V)):db(b,c,.8>ba()?1:V)):Ia[d]&&(a.position.sub(a.direction),a.direction.y*=-1)}},w:Ib,f:.1}),ta=ka(450,{position:s(),d:90,A:10,duration:-1,l:0,q:1,r:s(3,3),g:22,C:12,size:30*
h|0,i:15*h|0,u:5*h,speed:4*h,v:1*h,n:-1,f:.1}),Wa=ka(250,{position:s(),d:0,A:360,duration:-1,k:[230,150,150,.1],o:[20,20,20,.1],l:s(0,.4),q:2.5,r:s(3,3),g:82,C:12,size:8*h|0,i:2*h|0,speed:5*h,v:1*h,h:[250,160,160,1],D:[5,5,5,0],w:Ib,f:.1}),Ta=ka(100,{l:0,position:s(),h:[200,50,50,.8],speed:e,q:3,aa:function(a,b){a.moveTo(b.ia.x,b.ia.y);a.lineTo(b.position.x,b.position.y)},J:function(a){if(!(0>a.c)){a.ia=kc(a.position,a.direction);for(var b=0;6>b&&a.c;b++){var c=a.position.x,d=a.position.y;d>F&&(a.c*=
.8,Hb(a));M(Aa,function(b){var e=b.x-b.ba/2,g=b.y-b.m/2;c>e&&c<e+b.ba&&d>g&&d<g+b.m&&(a.c=0,Wa.e(c,d),b.N--,b.W=5)});var k=(c/e|0)+1,l=(d/e|0)+1,g=qa(k,l);if(g==ra||g==Qa)if(O.e(c,d),g==Qa)a.c*=.8,U.speed=3*h,U.e(c,d),db(k,l,V);else{a.c=0;db(k,l,.8>ba()?1:V);continue}else if(Ia[g]){a.c=0;Wa.e(c,d);continue}a.position.add(a.direction)}a.c||(a.position.sub(a.direction),a.c=1E-5)}}}),ob=ka(Ub,{position:s(d.a.x,-60*e),d:90,A:180,duration:-1,k:[240,240,250,.1],o:[10,10,10,0],l:s(0,.02),q:25,r:s(.7*k,5*
e),g:12,C:12,size:20*h|0,i:10*h|0,u:2*h,s:[40,40,40,0],speed:.2*h,v:.1,h:[220,220,230,1],D:[22,22,22,0],w:Za,J:function(a,b){a.position.x+=D(x*b/50+.001*Ra);a.direction.y=K(a.direction.y,4*h)},f:.4}),ga=ka(350,{position:s(la/2,-125*e),d:0,duration:-1,l:0,q:10,n:-1,r:s(la/2,10*e),size:280*h|0,i:280*h|0,u:30,speed:.2*h,v:.1,w:Za,f:.3,J:function(a){a.c=1E3;a.position.x+=la;a.position.x%=la},aa:function(a,b){var c=b.size|0,d=b.position.x|0,e=b.position.y|0;if(!b.ga){var h=100*b.f|0,h=T(6,29,h),g=jb[h].shift();
jb[h].push(g);b.ga=g}a.drawImage(b.ga,d,e,2*c,c)}}),O=ka(250,{position:s(),d:-90,A:20,duration:10,k:[40,40,40,0],o:[10,10,10,0],l:s(0,-.25),q:.8,Z:.2,r:s(2,2),g:12,C:12,size:45*h|0,i:60*h|0,u:6*h,s:[0,0,0,0],speed:1.2*h,v:.1,h:[220,220,220,1],D:[22,22,22,0],w:Za,f:.8}),U=ka(250,{position:s(),d:-90,A:80,duration:.15,k:[40,70,140,.2],o:[10,10,10,0],s:[140,140,255,0],h:[60,80,120,.9],D:[12,12,12,0],l:s(0,.5),q:1.2,Z:.2,r:s(16,4),g:72,C:12,size:14,i:8,u:1,n:100,speed:2*h,v:.5,J:function(a){a.position.y>
F&&0<a.direction.y&&(a.c=0)},w:Za,f:.05}),Ra=0,dc=.4*Va+20*e,nb=0,ib;R("Almost Ready...",10,function(){B(ga.U,function(){.22>ba()&&(ga.position.y+=2,ga.f*=.98);var a=ga.e();a.i=a.size;a.ca=0});L.font="20px Verdana";L.textAlign="center";L.fillStyle="#fff"});R("Ready!",2,function(){var a=J.getElementById("start");a.value="Press to Start!";a.disabled=!1;ib=J.getElementById("overlay");Ya(zb);a.onclick=function(){Sa=!0;ib.style.display="none"}});yb()})();
